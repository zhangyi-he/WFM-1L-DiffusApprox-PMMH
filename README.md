# Estimating temporally variable selection intensity from ancient DNA data
The source code is implemented for an MCMC-based method for inferring temporally variable selection from ancient DNA data (in the format of genotype likelihoods), and the preprint has been accepted by Molecular Biology and Evolution, available at https://doi.org/10.1093/molbev/msad008. Except for the PMMH procedure described in the manuscript, we also provide an adaptive version that improves the convergence of the chain.

[Code v1.0](https://github.com/zhangyi-he/WFM-1L-DiffusApprox-PMMH/tree/main/Code%20v1.0) includes the source code implemented for the case of constant natural selection and constant demographic histories with called genotypes as input.

[Code v1.1](https://github.com/zhangyi-he/WFM-1L-DiffusApprox-PMMH/tree/main/Code%20v1.1) includes the source code implemented for the case of constant natural selection and non-constant demographic histories with called genotypes as input.

[Code v1.2](https://github.com/zhangyi-he/WFM-1L-DiffusApprox-PMMH/tree/main/Code%20v1.2) / [Code v1.2.1](https://github.com/zhangyi-he/WFM-1L-DiffusApprox-PMMH/tree/main/Code%20v1.2.1) includes the source code implemented for the case of non-constant natural selection and non-constant demographic histories with called genotypes as input. Note that [Code v1.2.1](https://github.com/zhangyi-he/WFM-1L-DiffusApprox-PMMH/tree/main/Code%20v1.2.1) provides a version that no loss or fixation event occurred in the underlying population.

[Code v1.3](https://github.com/zhangyi-he/WFM-1L-DiffusApprox-PMMH/tree/main/Code%20v1.3) includes the source code implemented for the case of non-constant natural selection and non-constant demographic histories with called genotypes as input, where the underlying frequency trajectory of the mutant allele in the population is jointly estimated.

[Code v1.4](https://github.com/zhangyi-he/WFM-1L-DiffusApprox-PMMH/tree/main/Code%20v1.4) / [Code v1.4.1](https://github.com/zhangyi-he/WFM-1L-DiffusApprox-PMMH/tree/main/Code%20v1.4.1) includes the source code implemented for the case of non-constant natural selection and non-constant demographic histories with genotype likelihoods as input, where the underlying frequency trajectory of the mutant allele in the population is jointly estimated. Note that [Code v1.4.1](https://github.com/zhangyi-he/WFM-1L-DiffusApprox-PMMH/tree/main/Code%20v1.4.1) provides a more computationally efficient version.

[Code v1.5](https://github.com/zhangyi-he/WFM-1L-DiffusApprox-PMMH/tree/main/Code%20v1.5) includes the source code implemented for the case of non-constant natural selection and non-constant demographic histories with genotype likelihoods as input, where the dominance parameter and the underlying frequency trajectory of the mutant allele in the population are jointly estimated.

[Data](https://github.com/zhangyi-he/WFM-1L-DiffusApprox-PMMH/tree/main/Data) includes the ancient horse samples genotyped at the loci for coat colouration.
